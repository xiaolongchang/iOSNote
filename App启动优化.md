# App启动优化

1、名词解释

冷启动:App 点击启动前，它的进程不在系统里，需要系统新创建一个进程分配给它启动的情况。这是一次完整的启动过程。

热启动:App 在冷启动后用户将 App 退后台，在 App 的进程还在系统里的情况下，用户重新启动进入 App 的过程，这个过程做的事情非常少。

Other:有其他说法把 app杀死进程后 再次打开app定义为热启动，因为此时系统进程中还存在app的进程，这种说法把app在后台返回前台称为返回前台；

2、耗时操作

耗时操作一般发生在冷启动过程中，其中主要分位三个阶段

- main 函数执行之前

    Tips:

    a、<***dylib = dynamic library  动态库***>

    b、<***dyld = dynamic link editor 动态链接器** 一个专门用来加载动态链接库的库>*

    - 动态库链接，进行 rebase 指针调整和 bind 符号绑定
    - 加载可执行文件（app .o文件集合）
    - Objc运行时初始处理：objc 相关类注册、selecter 唯一性检查、category 注册等
    - 初始化，包含：+load()方法执行、attribute((constructor))修饰函数的调用、创建 C++ 静态全局变量；

    优化方式：

    - 减少动态库加载，尽可能多的合并动态库
    - 减少加载启动后不使用的类和方法
    - +load() 方法中尽量少内容调用，该方法有耗时，或者使用+initialize()替换
    - 控制尽量少的 C++全局变量的数量
- main 函数执行之后
    - 部分概念

        首屏渲染：从main方法结束后，到didFinishLaunchingWithOptions方法结束前，属于首屏渲染；

    - 抓取方法执行时间
        - objc_msgSend 方法进行 hook 来掌握所有方法的执行耗时
        - timeProfiler
    - 其他工具

    优化方式：

    非必须初始化操作，都可以在使用的时候进行去进行初始化，就会分离时间；